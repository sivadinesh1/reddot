<ion-content>
	<div class="screen-header">
		<div>
			<span
				style="color: #310ac0; cursor: pointer"
				(click)="viewAllCustomers()"
			>
				All Customers
			</span>
			/ <span style="color: #797979">{{customerdata?.name}}</span> /
			<span style="color: #797979">Financial Transactions</span>
		</div>
		<div>&nbsp;</div>
	</div>

	<div style="display: flex; background-color: #f8f8fb">
		<div
			style="
				align-self: center;
				font-size: 16px;
				padding: 8px 16px 8px 32px;
				color: darkblue;
			"
		>
			<div style="font-size: 12px; color: grey; padding: 6px 0px">
				Credit Available
			</div>
			<div>{{ customerdata.credit_amt | currency: "INR"}}</div>
		</div>
		<div
			style="
				align-self: center;
				font-size: 16px;
				padding: 8px 16px 8px 32px;
				color: darkblue;
			"
		>
			<div style="font-size: 12px; color: grey; padding: 6px 0px">
				Total Outstanding Balance
			</div>
			<div style="font-size: 16px; color: red">
				{{ this.totalOutstandingBalance | currency: "INR"}}
			</div>
		</div>
	</div>

	<div class="search-wrap">
		<div
			style="width: 94%; margin: 0 auto; padding-top: 16px"
			[@.disabled]="true"
		>
			<mat-tab-group
				color="primary"
				[(selectedIndex)]="tabIndex"
				(selectedTabChange)="tabClick($event)"
			>
				<mat-tab label="Invoices">
					<ng-template [ngTemplateOutlet]="INVTABLE"></ng-template>
				</mat-tab>

				<mat-tab label="Payments">
					<ng-template [ngTemplateOutlet]="PYMTTABLE"></ng-template>
				</mat-tab>

				<mat-tab label="Ledger">
					<ng-template [ngTemplateOutlet]="LEDGERTABLE"></ng-template>
				</mat-tab>

				<mat-tab label="Transactions">
					<ng-template [ngTemplateOutlet]="TXNTABLE"></ng-template>
				</mat-tab>
			</mat-tab-group>
		</div>
	</div>

	<ng-template #INVTABLE>
		<ng-container>
			<div class="example-container mat-elevation-z8">
				<div class="row1">
					<div class="search_box">
						<ion-searchbar
							autofocus
							debounce="300"
							placeholder="Type to search from Transactions"
							#searchbartab1
							show-cancel-button="focus"
							(ionClear)="resetTab1()"
							(ionInput)="applyFilter1($event.target.value)"
						></ion-searchbar>
					</div>
					<div class="actions">
						<img
							src="/assets/images/svg/download-excel.svg"
							style="cursor: pointer"
							width="32px"
							height="32px"
						/>
					</div>
				</div>
				<div class="example-table-container" #epltable0>
					<table
						mat-table
						[dataSource]="saleInvoicedataSource"
						multiTemplateDataRows
					>
						<ng-container matColumnDef="invoicedate">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Invoice Date
							</th>
							<td
								mat-cell
								*matCellDef="let element"
								class="m-card-title"
								style="color: #333333; font-weight: 500"
							>
								{{(element.invoice_date )}}
							</td>
						</ng-container>

						<ng-container matColumnDef="invoiceno">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Inv #
							</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">
								{{(element.invoice_no)}}
							</td>
						</ng-container>

						<ng-container matColumnDef="paymentstatus">
							<th
								class="m-txt-field"
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Payment Status
							</th>
							<td mat-cell *matCellDef="let element" class="m-txt-field">
								{{(element.payment_status)}}
							</td>
						</ng-container>

						<ng-container matColumnDef="nettotal">
							<th
								class="m-curr-field"
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Invoice Amount
							</th>
							<td mat-cell *matCellDef="let element" class="m-curr-field">
								{{(element.invoice_amt | currency: "INR" )}}
							</td>
						</ng-container>

						<ng-container matColumnDef="paidamt">
							<th
								class="m-curr-field"
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Paid Amount
							</th>
							<td mat-cell *matCellDef="let element" class="m-curr-field">
								{{(element.paid_amount | nullzero | currency: "INR" )}}
							</td>
						</ng-container>

						<ng-container matColumnDef="balamt">
							<th
								class="m-curr-field"
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Balance Amount
							</th>
							<td mat-cell *matCellDef="let element" class="m-curr-field">
								{{(element.bal_amount | nullzero | currency: "INR" )}}
							</td>
						</ng-container>

						<ng-container matColumnDef="paybtn">
							<th mat-header-cell *matHeaderCellDef>&nbsp;</th>
							<td mat-cell *matCellDef="let element" class="m-curr-field">
								<button
									*ngIf="element.payment_status !== 'PAID'"
									mat-button
									appPreventDoubleClick
									(throttledClick)="addPayments(element)"
									[throttleTime]="500"
									mat-button
									color="warn"
								>
									Record Payment
								</button>
							</td>
						</ng-container>

						<!-- <ng-container matColumnDef="type">
							<th mat-header-cell *matHeaderCellDef>Type</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">{{element.ledger_detail}}</td>
						</ng-container> -->

						<tr
							mat-header-row
							*matHeaderRowDef="saleInvoiceDisplayedColumns; sticky: true"
						></tr>

						<tr
							class="example-element-row"
							mat-row
							*matRowDef="let row; columns: saleInvoiceDisplayedColumns;"
						></tr>
					</table>
					<div [hidden]="isTableHasData" class="center-message">
						No Data available.
					</div>
				</div>
				<mat-paginator
					#InvoiceTablePaginator="matPaginator"
					[pageSizeOptions]="[100, 200]"
					showFirstLastButtons
				></mat-paginator>
			</div>
			<mat-menu #menu="matMenu">
				<ng-template matMenuContent let-element="element">
					<button mat-menu-item>
						<mat-icon>edit </mat-icon>
						<span>Edit</span>
					</button>
				</ng-template>
			</mat-menu>
		</ng-container>
	</ng-template>

	<ng-template #PYMTTABLE>
		<ng-container>
			<div class="example-container mat-elevation-z8">
				<div class="row1">
					<div class="search_box">
						<ion-searchbar
							autofocus
							debounce="300"
							placeholder="Type to search from Transactions"
							#searchbartab2
							show-cancel-button="focus"
							(ionClear)="resetTab2()"
							(ionInput)="applyFilter2($event.target.value)"
						></ion-searchbar>
					</div>
					<div class="actions">
						<img
							src="/assets/images/svg/download-excel.svg"
							style="cursor: pointer"
							width="32px"
							height="32px"
						/>
					</div>
				</div>
				<div class="example-table-container" #epltable1>
					<table
						mat-table
						[dataSource]="paymentdataSource"
						multiTemplateDataRows
					>
						<ng-container matColumnDef="pymtdate">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="
									color: #333333;
									font-size: 14px;
									font-weight: 500;
									width: 150px;
								"
							>
								Payment Date
							</th>
							<td
								mat-cell
								*matCellDef="let element"
								class="m-card-title"
								style="color: #333333; font-weight: 500; width: 150px"
							>
								{{(element.pymt_date )}}
							</td>
						</ng-container>

						<ng-container matColumnDef="invoiceno">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="
									color: #333333;
									font-size: 14px;
									font-weight: 500;
									width: 150px;
								"
							>
								Invoice #
							</th>
							<td
								mat-cell
								*matCellDef="let element"
								class="m-card-title"
								style="width: 150px"
							>
								INV-{{(element.invoice_no )}}
							</td>
						</ng-container>

						<ng-container matColumnDef="invoicedate">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="
									color: #333333;
									font-size: 14px;
									font-weight: 500;
									width: 150px;
								"
							>
								Invoice Date
							</th>
							<td
								mat-cell
								*matCellDef="let element"
								style="width: 150px"
								class="m-card-title"
							>
								{{(element.invoice_date )}}
							</td>
						</ng-container>

						<ng-container matColumnDef="invoiceamt">
							<th
								class="m-curr-field"
								mat-header-cell
								*matHeaderCellDef
								style="
									color: #333333;
									font-size: 14px;
									font-weight: 500;
									width: 150px;
								"
							>
								Invoice Amount
							</th>
							<td
								mat-cell
								*matCellDef="let element"
								style="width: 150px"
								class="m-curr-field"
							>
								{{element.invoice_amount | currency: "INR"}}
							</td>
						</ng-container>

						<ng-container matColumnDef="paymentno">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="
									color: #333333;
									font-size: 14px;
									font-weight: 500;
									width: 150px;
								"
							>
								Pymt #
							</th>
							<td
								mat-cell
								*matCellDef="let element"
								style="width: 150px"
								class="m-card-title"
							>
								{{(element.payment_no)}}
							</td>
						</ng-container>

						<ng-container matColumnDef="bankref">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Bank Notes
							</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">
								{{(element.bank_ref)}}
							</td>
						</ng-container>

						<ng-container matColumnDef="pymtref">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Notes
							</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">
								{{(element.pymt_ref)}}
							</td>
						</ng-container>

						<ng-container matColumnDef="nowpaid">
							<th
								class="m-curr-field"
								mat-header-cell
								*matHeaderCellDef
								style="
									color: #333333;
									font-size: 14px;
									font-weight: 500;
									width: 150px;
								"
							>
								Amount Received
							</th>
							<td
								mat-cell
								*matCellDef="let element"
								style="width: 150px"
								class="m-curr-field"
							>
								<div>{{element.payment_now_amt | currency: "INR"}}</div>
								<div style="font-size: 12px; color: #797979">
									{{element.payment_now_amt !== element.invoice_amount ? 'Split
									Payment' : ""}}
								</div>
							</td>
						</ng-container>

						<ng-container matColumnDef="paidamt">
							<th
								class="m-curr-field"
								mat-header-cell
								*matHeaderCellDef
								style="
									color: #333333;
									font-size: 14px;
									font-weight: 500;
									width: 150px;
								"
							>
								Applied Amount
							</th>
							<td
								mat-cell
								*matCellDef="let element"
								style="width: 150px"
								class="m-curr-field"
							>
								{{element.applied_amount | currency: "INR"}}
							</td>
						</ng-container>

						<tr
							mat-header-row
							*matHeaderRowDef="paymentDisplayedColumns; sticky: true"
						></tr>

						<tr
							class="example-element-row"
							mat-row
							*matRowDef="let row; columns: paymentDisplayedColumns;"
						></tr>
					</table>
					<div [hidden]="isTableHasData" class="center-message">
						No Data available.
					</div>
				</div>
				<mat-paginator
					#PaymentTablePaginator="matPaginator"
					[pageSize]="100"
					[pageSizeOptions]="[100, 200]"
					showFirstLastButtons
				></mat-paginator>
			</div>
			<mat-menu #menu="matMenu">
				<ng-template matMenuContent let-element="element">
					<button mat-menu-item>
						<mat-icon>edit </mat-icon>
						<span>Edit</span>
					</button>
				</ng-template>
			</mat-menu>
		</ng-container>
	</ng-template>

	<ng-template #LEDGERTABLE>
		<ng-container>
			<div class="example-container mat-elevation-z8">
				<div class="row1">
					<div class="search_box">
						<ion-searchbar
							autofocus
							debounce="300"
							placeholder="Type to search from Ledger"
							#searchbartab3
							show-cancel-button="focus"
							(ionClear)="resetTab3()"
							(ionInput)="applyFilter3($event.target.value)"
						></ion-searchbar>
					</div>
					<div class="actions">
						<img
							src="/assets/images/svg/download-excel.svg"
							style="cursor: pointer"
							width="32px"
							height="32px"
						/>
					</div>
				</div>
				<div class="example-table-container" #epltable>
					<table
						mat-table
						[dataSource]="ledgerdataSource"
						multiTemplateDataRows
					>
						<ng-container matColumnDef="ledgerdate">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Ledger Date
							</th>
							<td
								mat-cell
								*matCellDef="let element"
								class="m-card-title"
								style="color: #333333; font-weight: 500"
							>
								{{(element.ledger_date | date: 'dd/MMM/yyyy')}}
							</td>
						</ng-container>

						<ng-container matColumnDef="ledgerrefid">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Inv / Pay #
							</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">
								{{(element.invoice_ref_id === null ? element.payment_ref_id :
								element.invoice_ref_id)}}
							</td>
						</ng-container>

						<ng-container matColumnDef="type">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Type
							</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">
								{{element.ledger_detail}}
							</td>
						</ng-container>

						<ng-container matColumnDef="creditamt">
							<th
								class="m-curr-field"
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Credit
							</th>
							<td mat-cell *matCellDef="let element" class="m-curr-field">
								{{element.credit_amt | currency: "INR"}}
							</td>
						</ng-container>

						<ng-container matColumnDef="debitamt">
							<th
								class="m-curr-field"
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Debit
							</th>
							<td mat-cell *matCellDef="let element" class="m-curr-field">
								{{element.debit_amt | currency: "INR"}}
							</td>
						</ng-container>

						<ng-container matColumnDef="balamt">
							<th
								class="m-curr-field"
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Balance
							</th>
							<td mat-cell *matCellDef="let element" class="m-curr-field">
								{{element.balance_amt | currency: "INR"}}
							</td>
						</ng-container>

						<tr
							mat-header-row
							*matHeaderRowDef="displayedColumns; sticky: true"
						></tr>

						<tr
							class="example-element-row"
							mat-row
							*matRowDef="let row; columns: displayedColumns;"
						></tr>
					</table>
					<div [hidden]="isTableHasData" class="center-message">
						No Data available.
					</div>
				</div>
				<mat-paginator
					#LedgerTablePaginator="matPaginator"
					[pageSizeOptions]="[100, 200]"
					showFirstLastButtons
				></mat-paginator>
			</div>
			<mat-menu #menu="matMenu">
				<ng-template matMenuContent let-element="element">
					<button mat-menu-item>
						<mat-icon>edit </mat-icon>
						<span>Edit</span>
					</button>
				</ng-template>
			</mat-menu>
		</ng-container>
	</ng-template>

	<ng-template #TXNTABLE>
		<ng-container>
			<div class="example-container mat-elevation-z8">
				<div class="row1">
					<div class="search_box">
						<ion-searchbar
							autofocus
							debounce="300"
							placeholder="Type to search from Transactions"
							#searchbartab4
							show-cancel-button="focus"
							(ionClear)="resetTab4()"
							(ionInput)="applyFilter4($event.target.value)"
						></ion-searchbar>
					</div>
					<div class="actions">
						<img
							src="/assets/images/svg/download-excel.svg"
							style="cursor: pointer"
							width="32px"
							height="32px"
						/>
					</div>
				</div>
				<div class="example-table-container" #epltable1>
					<table
						mat-table
						[dataSource]="pymttransactionsdataSource"
						multiTemplateDataRows
					>
						<ng-container matColumnDef="pymtdate">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Payment Date
							</th>
							<td
								mat-cell
								*matCellDef="let element"
								class="m-card-title"
								style="color: #333333; font-weight: 500"
							>
								{{(element.pymt_date | date: 'dd/MMM/yyyy')}}
							</td>
						</ng-container>

						<ng-container matColumnDef="pymtno">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Payment #
							</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">
								{{(element.payment_no )}}
							</td>
						</ng-container>

						<ng-container matColumnDef="paidamt">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Paid Amount
							</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">
								{{(element.payment_now_amt | currency: "INR" )}}
							</td>
						</ng-container>

						<ng-container matColumnDef="paymode">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Pay Mode
							</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">
								{{(element.pymt_mode )}}
							</td>
						</ng-container>

						<ng-container matColumnDef="payref">
							<th
								mat-header-cell
								*matHeaderCellDef
								style="color: #333333; font-size: 14px; font-weight: 500"
							>
								Pymt Reference
							</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">
								{{(element.pymt_ref)}}
							</td>
						</ng-container>

						<tr
							mat-header-row
							*matHeaderRowDef="pymtTxnDisplayedColumns; sticky: true"
						></tr>

						<tr
							class="example-element-row"
							mat-row
							*matRowDef="let row; columns: pymtTxnDisplayedColumns;"
						></tr>
					</table>
					<div [hidden]="isTableHasData" class="center-message">
						No Data available.
					</div>
				</div>
				<mat-paginator
					#PymtTransactionTablePaginator="matPaginator"
					[pageSize]="100"
					[pageSizeOptions]="[100, 200]"
					showFirstLastButtons
				></mat-paginator>
			</div>
		</ng-container>
	</ng-template>
</ion-content>
