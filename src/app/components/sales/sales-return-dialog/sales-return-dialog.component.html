<ion-content>
	<div class="screen-header">
		<div>&nbsp;</div>

		<div style="align-items: center">
			<img class="cursor" src="/assets/images/svg/close.svg" (click)="close()" width="16px" height="16px" />
		</div>
	</div>

	<div class="action-row">
		<div>SALES RETURN</div>
		<div>&nbsp;</div>
	</div>

	<div class="customer-info">
		<div style="padding: 5px">
			<div style="font-size: 13px; font-weight: 400; opacity: 0.6">Invoice #</div>
			<div style="font-size: 14px; font-weight: 400">{{ this.salemasterdata?.invoice_no }}</div>
		</div>

		<div style="padding: 5px">
			<div style="font-size: 13px; font-weight: 400; opacity: 0.6">Invoice Date</div>
			<div style="font-size: 14px; font-weight: 400">{{ this.salemasterdata?.invoice_date }}</div>
		</div>

		<div style="padding: 5px">
			<div style="font-size: 13px; font-weight: 400; opacity: 0.6">Status</div>
			<div style="font-size: 14px; font-weight: 400">{{ this.salemasterdata?.status === "C" ? "Completed" : "" }}</div>
		</div>
	</div>

	<div #epltable>
		<table style="width: 100%">
			<thead>
				<tr class="header">
					<th style="text-align: left">SNo</th>
					<th style="text-align: left">CODE</th>
					<th style="text-align: left">DESCRIPTION</th>
					<th style="text-align: left">QTY</th>
					<th style="text-align: right">RETURN NOW</th>
					<th style="text-align: right">MRP</th>
					<th style="text-align: right">DIS%</th>

					<th style="text-align: right">TAX</th>

					<th style="text-align: right">NET AMNT</th>
				</tr>
			</thead>
			<tbody>
				<tr *ngFor="let item of returnArr ? returnArr : []; let idx = index" class="list-item row-color">
					<td style="text-align: left">{{ idx + 1 }}</td>
					<td>{{ item.product_code }}</td>
					<td>{{ item.description }}</td>

					<td style="text-align: left">&nbsp;&nbsp;Ordered: {{ item?.qty }} Returned: {{ item?.returned }}</td>
					<td style="text-align: left">
						<mat-form-field *ngIf="item?.qty !== item?.returned" style="width: 50px; margin-bottom: -1.25em; text-align: right">
							<input
								matInput
								name="received_now"
								type="number"
								(blur)="update_change($event, idx)"
								value="{{ item?.received_now }}"
								min="0"
								max="{{ item?.qty - item?.returned }}"
							/>
							<div *ngIf="item?.error" style="font-size: 11px; color: red">Mismatch</div>
						</mat-form-field>
						<div style="text-align: center !important" *ngIf="item?.qty === item?.returned">-</div>
					</td>

					<td style="text-align: right">{{ (+item?.mrp).toFixed(2) }}</td>
					<td style="text-align: right">
						<mat-form-field style="width: 50px; margin-bottom: -1.25em; text-align: right">
							<input
								matInput
								name="disc_value"
								type="number"
								(change)="update_disc_value($event, idx)"
								value="{{ item?.disc_percent }}"
								min="0"
								max="100"
							/>
						</mat-form-field>
					</td>
					<td style="text-align: right">{{ item?.taxrate }}</td>
					<td style="text-align: right">{{ (+item?.total_value).toFixed(2) }}</td>
				</tr>
			</tbody>
		</table>
	</div>
	<div *ngIf="nothingToReturnMsg" style="text-align: center; padding: 10px; color: red">
		<div>{{ this.nothingToReturnMsg }}</div>
	</div>
	<div style="display: flex; justify-content: center; padding-top: 10px">
		<button mat-raised-button color="primary" style="font-size: 1rem" (click)="return()">Return</button>&nbsp;&nbsp;
		<button mat-raised-button color="secondary" style="font-size: 1rem" (click)="cancel()">Cancel</button>
	</div>
</ion-content>
