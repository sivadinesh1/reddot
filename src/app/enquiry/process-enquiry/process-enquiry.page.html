<!-- @format -->

<ion-content>
	<div class="screen-header">
		<div>
			<span style="color: #310ac0; cursor: pointer;" (click)="openEnquiry()">Inquiry Dashboard</span> /
			<span style="color: #797979;">Order Processing #{{enqid}}</span>
		</div>
		<div>
			&nbsp;
		</div>
	</div>
	<div class="topcontainer">
		<div class="cust-header" *ngIf="enqDetailsOrig">
			<div>
				<div class="cust-lbl">Customer:</div>
				<div>
					<div>{{enqDetailsOrig[0].name}}</div>
					<div>{{enqDetailsOrig[0].address1}}</div>
					<div>{{enqDetailsOrig[0].address2}}</div>
					<div>{{enqDetailsOrig[0].district}}</div>
				</div>
			</div>
			<div>
				<div class="cust-lbl">Remarks</div>
				<div>{{enqDetailsOrig[0].remarks}}</div>
			</div>
			<div>
				<div *ngIf="status === 'E'">
					<div class="cust-lbl">Status:</div>
					<div style="color: red;">Executed</div>
				</div>
				<div *ngIf="status === 'D'">
					<div class="cust-lbl">Status:</div>
					<div style="color: red;">Draft</div>
				</div>
				<div *ngIf="status === 'O'">
					<div class="cust-lbl">Status:</div>
					<div style="color: red;">New</div>
				</div>
			</div>
			<!-- <div style="text-align: right; align-items: center;">
				
			</div> -->
		</div>
	</div>

	<div class="row1">
		<div class="search_box">
			<ion-searchbar
				autofocus
				debounce="300"
				placeholder="Search by item name"
				#mySearchbar
				show-cancel-button="focus"
				(ionClear)="reset()"
				(ionInput)="applyFilter($event.target.value)"
			></ion-searchbar>
		</div>
		<div class="actions">
			<button appPreventDoubleClick (throttledClick)="openAddItem()" *ngIf="status !== 'E'" [throttleTime]="500" mat-raised-button color="primary">
				+ Add Item
			</button>
		</div>
		<div class="actions">
			<img src="/assets/images/svg/download-excel.svg" style="cursor: pointer;" width="32px" height="32px" (click)="exportToExcel()" />
		</div>
	</div>

	<div class="container">
		<!-- <div class="process-enq-wrap">
			<div class="process-prep-enq-heading">
				<div class="c-pad-mini">#</div>
				<div class="c-pad-mini">Prod Info</div>
				<div class="c-pad-mini">Rack#</div>
				<div class="c-pad-mini">Alot. Qty</div>
				<div class="c-pad-mini" style="padding-left: 10px;">Notes</div>
				<div class="c-pad-mini">Req. Qty</div>
				<div class="c-pad-mini">&nbsp;</div>
			</div>
			<div class="list-items">
				<div *ngFor="let item of productArr; let idx = index;" (click)="onClick(item)" style="border-bottom: 1px solid dimgrey;">
					<div class="process-enq-list">
						<div>
							<div class="c-pad">
								{{idx+1}}
							</div>
						</div>
						<div>
							<div *ngIf="item.product_code" class="pdetails">
								<div class="pcode">
									{{item.product_code}}
									<span class="avlstock">Stock: {{item.available_stock}}</span>&nbsp;&nbsp;&nbsp;
									<span class="" *ngIf="item.product_code" (click)="showAddProductComp(idx)">
										<span style="font-size: 12px; color: rgb(230, 61, 10);">Edit</span>
									</span>
								</div>
								<div class="pdesc">{{item.product_desc}}</div>
							</div>
							<div *ngIf="!item.product_code" class="left-align c-pad">
								<div class="" *ngIf="!item.product_code" (click)="showAddProductComp(idx)">
									<div><img src="/assets/images/svg/more.svg" width="18px" height="18px" /> Item Code</div>
								</div>
							</div>
						</div>
						<div style="font-size: 14px;">{{item.rackno}}</div>

						<div>
							<mat-form-field class="example-full-width">
								<input matInput type="number" value="{{item.giveqty}}" readonly />
								<mat-icon *ngIf="status !== 'E'" matSuffix (click)="openCurrencyPad(idx)">view_comfy</mat-icon>
							</mat-form-field>
						</div>

						<div style="background-color: #ffffee; margin-left: 10px;">
							<div class="c-pad">
								{{item.notes}}
							</div>
						</div>

						<div>
							<div class="c-pad">
								{{item.askqty}}
							</div>
						</div>
						<div style="justify-self: center; align-self: center;">
							<mat-checkbox *ngIf="status !== 'E'" [checked]="item.processed === 'YS'? true : false" (click)="checkedRow(idx)"></mat-checkbox>
						</div>
					</div>
				</div>
			</div>
			<div class="save-sec" *ngIf="status !== 'E'">
				<ion-button type="submit" fill="outline" (click)="presentAlertConfirm()">Ready for Invoice</ion-button>
				<ion-button type="button" (click)="save()">Save Draft</ion-button>
			</div>
		</div> -->

		<ng-container>
			<div class="example-container mat-elevation-z8">
				<div class="example-table-container" #epltable>
					<table mat-table [dataSource]="dataSource" multiTemplateDataRows>
						<ng-container matColumnDef="edit">
							<th mat-header-cell *matHeaderCellDef>&nbsp;</th>
							<td mat-cell *matCellDef="let element; let idx = dataIndex;" style="text-align: center;" class="m-card-title">
								<mat-icon *ngIf="element.product_code" (click)="showAddProductComp(idx)" style="cursor: pointer;">edit </mat-icon>
							</td>
						</ng-container>

						<ng-container matColumnDef="prodinfo">
							<th mat-header-cell *matHeaderCellDef>Item Info</th>
							<td mat-cell *matCellDef="let element; let idx = dataIndex;" class="m-card-title">
								{{element.prodinfo}}

								<div *ngIf="element.product_code" class="pdetails">
									<div class="pcode">
										{{element.product_code}}
										<span class="" *ngIf="element.product_code" (click)="showAddProductComp(idx)">
											<span style="font-size: 12px; color: rgb(230, 61, 10);">Edit</span>
										</span>
									</div>
									<div class="pdesc">{{element.product_desc}}</div>
								</div>
								<div *ngIf="!element.product_code" class="left-align c-pad" style="cursor: pointer;">
									<div class="" *ngIf="!element.product_code" (click)="showAddProductComp(idx)">
										<div><img src="/assets/images/svg/more.svg" width="18px" height="18px" /> Item Code</div>
									</div>
								</div>
							</td>
						</ng-container>

						<ng-container matColumnDef="avlstock">
							<th mat-header-cell *matHeaderCellDef>In stock</th>
							<td mat-cell *matCellDef="let element" style="text-align: center;" class="m-card-title">{{element.available_stock}}</td>
						</ng-container>

						<ng-container matColumnDef="rackno">
							<th mat-header-cell *matHeaderCellDef>Rack #</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">{{element.rakno}}</td>
						</ng-container>

						<ng-container matColumnDef="alotqty">
							<th mat-header-cell *matHeaderCellDef>A.Qty</th>
							<td mat-cell *matCellDef="let element; let idx = dataIndex;" class="m-card-title">
								<!-- {{element.givenqty}} -->

								<mat-form-field class="example-full-width">
									<input matInput type="number" value="{{element.giveqty}}" readonly />
									<mat-icon *ngIf="status !== 'E'" matSuffix style="cursor: pointer;" (click)="openCurrencyPad(idx)">view_comfy</mat-icon>
								</mat-form-field>
							</td>
						</ng-container>

						<ng-container matColumnDef="notes">
							<th mat-header-cell *matHeaderCellDef>Notes</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">{{element.notes}}</td>
						</ng-container>

						<ng-container matColumnDef="reqqty">
							<th mat-header-cell *matHeaderCellDef>R.Qty</th>
							<td mat-cell *matCellDef="let element" class="m-card-title">{{element.askqty}}</td>
						</ng-container>

						<!-- <ng-container matColumnDef="actions">
							<th mat-header-cell *matHeaderCellDef>&nbsp;</th>
							<td mat-cell *matCellDef="let element">
								<button mat-icon-button [matMenuTriggerFor]="menu" [matMenuTriggerData]="{element: element}">
									<mat-icon>more_vert</mat-icon>
								</button>
							</td>
						</ng-container> -->

						<tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>

						<tr class="example-element-row" mat-row *matRowDef="let row; columns: displayedColumns; "></tr>
					</table>
					<div [hidden]="isTableHasData" class="center-message">
						No Data available.
					</div>
				</div>
				<mat-paginator [pageSizeOptions]="[10, 20]" showFirstLastButtons></mat-paginator>
			</div>
			<!-- <mat-menu #menu="matMenu">
				<ng-template matMenuContent let-element="element">
					<button mat-menu-item>
						<mat-icon>edit </mat-icon>
						<span>Edit</span>
					</button>
				</ng-template>
			</mat-menu> -->
		</ng-container>
	</div>

	<!-- <ion-fab vertical="bottom" horizontal="end" slot="fixed">
		<ion-fab-button (click)="goEnquiryScreen()">
			<ion-icon name="add"></ion-icon>
		</ion-fab-button>
	</ion-fab> -->
</ion-content>
